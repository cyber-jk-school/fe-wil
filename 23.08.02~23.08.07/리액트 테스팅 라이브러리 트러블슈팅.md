# 리액트 테스팅 라이브러리(React Testing Library) 트러블슈팅

## 들어가며

7월 초 쯤 토스 과제테스트를 진행했습니다. 과제 내용을 자세하게 설명할 순 없지만 주어진 요구사항을 만족하도록 기능을 구현하고, 테스트 코드를 돌려 몇 개의 테스트 케이스가 통과하는지 제출하는 과제였습니다.

과제 내용은 접어두고, 테스트 코드를 작성해 본 적도 없고, 테스트를 돌려본 적도 없기 때문에 테스트가 잘 통과할까 걱정이었습니다.

## 문제 상황

두 가지 문제가 있었습니다.

1. 총 15개의 테스트 케이스 중 한 개도 통과하지 못함.
2. 브라우저에서 직접 테스트 할 때는 기능이 잘 동작하지만 테스트를 돌리면 통과하지 못함.

시험 중에 테스트 케이스가 한 개도 통과하지 못해서, 당황한 나머지 해결 방법을 찾지 못하고 테스트를 종료했었습니다. 테스트가 끝나고 찾아본 결과 테스트를 위해 구성해 놓은 마크업을, 컴포넌트 추상화하겠다고 변경해서 통과하지 못한 것이었습니다. (ex: label 태그와 input 태그 연결)

두 번째 문제는 최근에서야 해결했는데, 브라우저에서 직접 클릭해서 테스트 할 때는 기능이 제대로 동작했는데 테스트만 하면 통과하지 못하는 문제였습니다. 많은 삽질이 있었지만 원인은 상태 변경이 일어난 후 클릭 이벤트가 발생해야 하는데 그 사이에 딜레이가 없어 상태 변경에 따른 화면 렌더링이 완료되지 않은 상태로 클릭 이벤트를 실행해서 생긴 문제였습니다.

문서를 찾아봤는데 [Async Methods](https://testing-library.com/docs/dom-testing-library/api-async/) 라는 이름으로 문서를 제공하고 있습니다.

> Several utilities are provided for dealing with asynchronous code. These can be useful to wait for an element to appear or disappear in response to an event, user action, timeout, or Promise.

> 비동기 코드를 처리하기 위해 몇 가지 유틸리티가 제공됩니다. 해당 유틸리티는 이벤트, 유저 액션, 타임아웃, 프로미스의 응답으로 나타나거나 사라지는 요소를 기다릴 때 유용합니다.
